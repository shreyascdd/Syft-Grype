name: Anchore Syft SBOM scan

on:
  workflow_dispatch:   # only manual trigger

jobs:
  Anchore-Build-Scan:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout the code
      uses: actions/checkout@v4

    # Build frontend image
    - name: Build frontend Docker image
      run: docker build ./frontend --file frontend/Dockerfile --tag localbuild/frontend:latest

    # Build backend image
    - name: Build backend Docker image
      run: docker build ./backend --file backend/Dockerfile --tag localbuild/backend:latest

    # Generate SBOM for frontend
    - name: Generate SBOM for frontend
      uses: anchore/sbom-action@v0
      with:
        image: "localbuild/frontend:latest"
        artifact-name: sbom-frontend

    # Generate SBOM for backend
    - name: Generate SBOM for backend
      uses: anchore/sbom-action@v0
      with:
        image: "localbuild/backend:latest"
        artifact-name: sbom-backend

    
